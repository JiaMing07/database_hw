statement ok
create table test_delete(id int, score double, info varchar(20));

query
insert into test_delete values(1, 1.1, 'a'), (2, 2.2, 'bb'), (3, 3.3, 'ccc');
----
3

query
delete from test_delete where id = 1;
----
1

query
insert into test_delete values(4, 4.4, 'dddd'), (5, 5.5, 'eeeee'), (6, 6.6, 'ffffff');
----
3

query
delete from test_delete where score < 5.0 and id >= 3;
----
2

# New page
query
insert into test_delete values(7, 7.7, 'ggggggg'), (8, 8.8, 'hhhhhhhh'), (9, 9.9, 'iiiiiiiii'), (10, 10.1, 'jjjjjjjjjj'), (11, 11.1, 'kkkkkkkkkkk');
----
5

query
delete from test_delete where id > 6;
----
5

statement ok
vacuum test_delete;

query
insert into test_delete values(1, 1.1, 'a');
----
1

# New page
query
insert into test_delete values(7, 7.7, 'lllllll'), (8, 8.8, 'mmmmmmmm'), (9, 9.9, 'nnnnnnnnn'), (10, 10.1, 'oooooooooo'), (11, 11.1, 'ppppppppppp');
----
5

query rowsort
select * from test_delete;
----
2 2.2 bb
5 5.5 eeeee
6 6.6 ffffff
1 1.1 a
7 7.7 lllllll
8 8.8 mmmmmmmm
9 9.9 nnnnnnnnn
10 10.1 oooooooooo
11 11.1 ppppppppppp


query
insert into test_delete values(12, 1.1, 'a'), (13, 2.2, 'bb'), (14, 3.3, 'ccc');
----
3

query rowsort
select * from test_delete;
----
2 2.2 bb
5 5.5 eeeee
6 6.6 ffffff
12 1.1 a
13 2.2 bb
14 3.3 ccc
1 1.1 a
7 7.7 lllllll
8 8.8 mmmmmmmm
9 9.9 nnnnnnnnn
10 10.1 oooooooooo
11 11.1 ppppppppppp
